# Staff Creation with OTP Verification - Visual Flow

## ğŸ¯ Complete User Journey

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  ğŸ‘¤ ADMIN: Creates New Staff Member                                  â”‚
â”‚                                                                       â”‚
â”‚  ğŸ“ Location: /staff/new                                             â”‚
â”‚  ğŸ–¥ï¸  Screen: Staff Information Form                                  â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Staff Information                                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Basic Information:                                          â”‚   â”‚
â”‚  â”‚  â€¢ Full Name: [Michel                    ]                  â”‚   â”‚
â”‚  â”‚  â€¢ Email: [mrsonu1589@gmail.com          ]                  â”‚   â”‚
â”‚  â”‚  â€¢ Role: [Manager - Department manager â–¼]                   â”‚   â”‚
â”‚  â”‚  â€¢ Employee ID: [EMP004                  ]                  â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â€¢ Department: [Cardiology               ]                  â”‚   â”‚
â”‚  â”‚  â€¢ Specialization: [erenwer              ]                  â”‚   â”‚
â”‚  â”‚  â€¢ License Number: [LIC123456            ]                  â”‚   â”‚
â”‚  â”‚  â€¢ Hire Date: [17-11-2025                ]                  â”‚   â”‚
â”‚  â”‚  â€¢ Employment Type: [Full-Time          â–¼]                  â”‚   â”‚
â”‚  â”‚  â€¢ Status: [Active                      â–¼]                  â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Emergency Contact:                                          â”‚   â”‚
â”‚  â”‚  â€¢ Contact Name: [John Doe               ]                  â”‚   â”‚
â”‚  â”‚  â€¢ Relationship: [Spouse                 ]                  â”‚   â”‚
â”‚  â”‚  â€¢ Phone: [+1234567890                   ]                  â”‚   â”‚
â”‚  â”‚  â€¢ Email: [emergency@example.com         ]                  â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  [Cancel]                        [Create Staff]             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Admin clicks "Create Staff"
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  ğŸ”„ BACKEND: Process Staff Creation Request                          â”‚
â”‚                                                                       â”‚
â”‚  ğŸ“ Endpoint: POST /api/staff/initiate                               â”‚
â”‚  ğŸ” Headers: X-Tenant-ID, Authorization                              â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. Validate Request                                         â”‚   â”‚
â”‚  â”‚     âœ“ Check tenant ID exists                                 â”‚   â”‚
â”‚  â”‚     âœ“ Verify admin authorization                             â”‚   â”‚
â”‚  â”‚     âœ“ Validate required fields                               â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  2. Check Email Availability                                 â”‚   â”‚
â”‚  â”‚     âœ“ Query users table                                      â”‚   â”‚
â”‚  â”‚     âœ— Reject if email exists                                 â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  3. Generate OTP                                             â”‚   â”‚
â”‚  â”‚     â€¢ Create 6-digit random code: 123456                     â”‚   â”‚
â”‚  â”‚     â€¢ Set expiration: NOW() + 15 minutes                     â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  4. Store Pending Data                                       â”‚   â”‚
â”‚  â”‚     INSERT INTO user_verification (                          â”‚   â”‚
â”‚  â”‚       email: 'mrsonu1589@gmail.com',                         â”‚   â”‚
â”‚  â”‚       code: '123456',                                        â”‚   â”‚
â”‚  â”‚       type: 'staff_creation',                                â”‚   â”‚
â”‚  â”‚       metadata: {staff_data},                                â”‚   â”‚
â”‚  â”‚       expires_at: '2025-11-16 12:15:00'                      â”‚   â”‚
â”‚  â”‚     )                                                        â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  5. Send Email via AWS SES                                   â”‚   â”‚
â”‚  â”‚     From: noreply@exo.com.np                                 â”‚   â”‚
â”‚  â”‚     To: mrsonu1589@gmail.com                                 â”‚   â”‚
â”‚  â”‚     Subject: Verify Your Email - Staff Account Creation      â”‚   â”‚
â”‚  â”‚     Body: Your verification code is: 123456                  â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  6. Return Success Response                                  â”‚   â”‚
â”‚  â”‚     {                                                        â”‚   â”‚
â”‚  â”‚       success: true,                                         â”‚   â”‚
â”‚  â”‚       message: "Verification code sent to email",            â”‚   â”‚
â”‚  â”‚       email: "mrsonu1589@gmail.com"                          â”‚   â”‚
â”‚  â”‚     }                                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Email sent successfully
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  ğŸ“§ EMAIL: Staff Receives Verification Code                          â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  From: Hospital Management System <noreply@exo.com.np>       â”‚   â”‚
â”‚  â”‚  To: mrsonu1589@gmail.com                                    â”‚   â”‚
â”‚  â”‚  Subject: Verify Your Email - Staff Account Creation         â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Welcome to the Hospital Management System!                  â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Hello Michel,                                               â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Your staff account is being created. Please verify your     â”‚   â”‚
â”‚  â”‚  email address using the code below:                         â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚   â”‚
â”‚  â”‚              â”‚   1  2  3  4  5  6   â”‚                            â”‚   â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  This code will expire in 15 minutes.                        â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  If you didn't request this, please ignore this email.       â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Staff opens email and gets OTP
                                â”‚ Frontend redirects to verification page
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  ğŸ‘¤ STAFF: Verifies Email with OTP                                   â”‚
â”‚                                                                       â”‚
â”‚  ğŸ“ Location: /staff/verify-otp?email=mrsonu1589@gmail.com          â”‚
â”‚  ğŸ–¥ï¸  Screen: Email Verification                                      â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ›¡ï¸  Email Verification                                       â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  We sent a 6-digit code to mrsonu1589@gmail.com             â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Verification Code:                                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚         1   2   3   4   5   6                        â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  The code will expire in 15 minutes                         â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  [          Verify Email          ]                         â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Didn't receive the code?                                   â”‚   â”‚
â”‚  â”‚  [ğŸ“§ Resend Code (60s)]                                     â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Tips:                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Check your spam folder                                   â”‚   â”‚
â”‚  â”‚  â€¢ Make sure you entered the correct email                  â”‚   â”‚
â”‚  â”‚  â€¢ The code is case-sensitive                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Staff enters OTP and clicks "Verify Email"
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  ğŸ”„ BACKEND: Verify OTP Code                                         â”‚
â”‚                                                                       â”‚
â”‚  ğŸ“ Endpoint: POST /api/staff/verify-otp                             â”‚
â”‚  ğŸ“¦ Body: { email, otp }                                             â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. Validate OTP                                             â”‚   â”‚
â”‚  â”‚     SELECT * FROM user_verification                          â”‚   â”‚
â”‚  â”‚     WHERE email = 'mrsonu1589@gmail.com'                     â”‚   â”‚
â”‚  â”‚       AND code = '123456'                                    â”‚   â”‚
â”‚  â”‚       AND type = 'staff_creation'                            â”‚   â”‚
â”‚  â”‚       AND expires_at > NOW()                                 â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  2. Check Results                                            â”‚   â”‚
â”‚  â”‚     âœ“ OTP found and valid                                    â”‚   â”‚
â”‚  â”‚     âœ“ Not expired                                            â”‚   â”‚
â”‚  â”‚     âœ“ Correct type                                           â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  3. Retrieve Staff Data                                      â”‚   â”‚
â”‚  â”‚     â€¢ Extract metadata from verification record              â”‚   â”‚
â”‚  â”‚     â€¢ Contains all staff information from Step 1             â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  4. Return Success                                           â”‚   â”‚
â”‚  â”‚     {                                                        â”‚   â”‚
â”‚  â”‚       success: true,                                         â”‚   â”‚
â”‚  â”‚       message: "Email verified successfully",                â”‚   â”‚
â”‚  â”‚       staffData: {metadata}                                  â”‚   â”‚
â”‚  â”‚     }                                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ OTP verified successfully
                                â”‚ Frontend redirects to password creation
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  ğŸ‘¤ STAFF: Creates Secure Password                                   â”‚
â”‚                                                                       â”‚
â”‚  ğŸ“ Location: /staff/create-password?email=...&otp=...               â”‚
â”‚  ğŸ–¥ï¸  Screen: Password Creation                                       â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ”’ Set Password                                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Creating account for mrsonu1589@gmail.com                   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Password:                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢                                  ğŸ‘ï¸    â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Confirm Password:                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢                                  ğŸ‘ï¸    â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  âœ“ Passwords match                                          â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Password Requirements:                                      â”‚   â”‚
â”‚  â”‚  âœ“ At least 8 characters                                    â”‚   â”‚
â”‚  â”‚  âœ“ One uppercase letter (A-Z)                               â”‚   â”‚
â”‚  â”‚  âœ“ One lowercase letter (a-z)                               â”‚   â”‚
â”‚  â”‚  âœ“ One number (0-9)                                         â”‚   â”‚
â”‚  â”‚  âœ“ One special character (!@#$%^&*)                         â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  [          Create Account          ]                       â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Security Tips:                                              â”‚   â”‚
â”‚  â”‚  â€¢ Use a unique password                                    â”‚   â”‚
â”‚  â”‚  â€¢ Avoid personal information                               â”‚   â”‚
â”‚  â”‚  â€¢ Consider using a password manager                        â”‚   â”‚
â”‚  â”‚  â€¢ Never share your password                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Staff creates password and clicks "Create Account"
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  ğŸ”„ BACKEND: Complete Staff Account Creation                         â”‚
â”‚                                                                       â”‚
â”‚  ğŸ“ Endpoint: POST /api/staff/complete                               â”‚
â”‚  ğŸ“¦ Body: { email, otp, password }                                   â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. Re-verify OTP                                            â”‚   â”‚
â”‚  â”‚     â€¢ Validate OTP is still valid                            â”‚   â”‚
â”‚  â”‚     â€¢ Retrieve staff data from metadata                      â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  2. Create Cognito User                                      â”‚   â”‚
â”‚  â”‚     AWS Cognito SignUp:                                      â”‚   â”‚
â”‚  â”‚     â€¢ Username: mrsonu1589_gmail_com                         â”‚   â”‚
â”‚  â”‚     â€¢ Password: [staff's password]                           â”‚   â”‚
â”‚  â”‚     â€¢ Email: mrsonu1589@gmail.com                            â”‚   â”‚
â”‚  â”‚     â€¢ Skip email verification (already verified)             â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  3. Confirm Cognito User                                     â”‚   â”‚
â”‚  â”‚     AdminConfirmSignUp:                                      â”‚   â”‚
â”‚  â”‚     â€¢ Mark user as confirmed                                 â”‚   â”‚
â”‚  â”‚     â€¢ Enable immediate login                                 â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  4. Create Database User                                     â”‚   â”‚
â”‚  â”‚     INSERT INTO users (                                      â”‚   â”‚
â”‚  â”‚       name: 'Michel',                                        â”‚   â”‚
â”‚  â”‚       email: 'mrsonu1589@gmail.com',                         â”‚   â”‚
â”‚  â”‚       password: [hashed],                                    â”‚   â”‚
â”‚  â”‚       status: 'active',                                      â”‚   â”‚
â”‚  â”‚       tenant_id: 'aajmin_polyclinic'                         â”‚   â”‚
â”‚  â”‚     )                                                        â”‚   â”‚
â”‚  â”‚     â†’ Returns user_id: 10                                    â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  5. Create Staff Profile                                     â”‚   â”‚
â”‚  â”‚     INSERT INTO staff_profiles (                             â”‚   â”‚
â”‚  â”‚       user_id: 10,                                           â”‚   â”‚
â”‚  â”‚       employee_id: 'EMP004',                                 â”‚   â”‚
â”‚  â”‚       department: 'Cardiology',                              â”‚   â”‚
â”‚  â”‚       specialization: 'erenwer',                             â”‚   â”‚
â”‚  â”‚       license_number: 'LIC123456',                           â”‚   â”‚
â”‚  â”‚       hire_date: '2025-11-17',                               â”‚   â”‚
â”‚  â”‚       employment_type: 'Full-Time',                          â”‚   â”‚
â”‚  â”‚       status: 'active',                                      â”‚   â”‚
â”‚  â”‚       emergency_contact: {contact_data}                      â”‚   â”‚
â”‚  â”‚     )                                                        â”‚   â”‚
â”‚  â”‚     â†’ Returns staff_id: 5                                    â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  6. Clean Up Verification Record                             â”‚   â”‚
â”‚  â”‚     DELETE FROM user_verification                            â”‚   â”‚
â”‚  â”‚     WHERE email = 'mrsonu1589@gmail.com'                     â”‚   â”‚
â”‚  â”‚       AND type = 'staff_creation'                            â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  7. Return Success                                           â”‚   â”‚
â”‚  â”‚     {                                                        â”‚   â”‚
â”‚  â”‚       success: true,                                         â”‚   â”‚
â”‚  â”‚       message: "Staff account created successfully",         â”‚   â”‚
â”‚  â”‚       data: {                                                â”‚   â”‚
â”‚  â”‚         staff: {staff_profile},                              â”‚   â”‚
â”‚  â”‚         user: {user_data}                                    â”‚   â”‚
â”‚  â”‚       }                                                      â”‚   â”‚
â”‚  â”‚     }                                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Account created successfully
                                â”‚ Frontend shows success message
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  âœ… SUCCESS: Staff Account Ready                                     â”‚
â”‚                                                                       â”‚
â”‚  ğŸ“ Location: /staff (redirected)                                    â”‚
â”‚  ğŸ–¥ï¸  Screen: Staff List                                              â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ‰ Staff account created successfully!                      â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Staff member can now login with:                            â”‚   â”‚
â”‚  â”‚  â€¢ Email: mrsonu1589@gmail.com                               â”‚   â”‚
â”‚  â”‚  â€¢ Password: [password they created]                         â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Staff List:                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ ID  â”‚ Name    â”‚ Email              â”‚ Department    â”‚    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚   â”‚
â”‚  â”‚  â”‚ 5   â”‚ Michel  â”‚ mrsonu1589@...     â”‚ Cardiology    â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ 4   â”‚ John    â”‚ john@...           â”‚ Emergency     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ 3   â”‚ Sarah   â”‚ sarah@...          â”‚ Pediatrics    â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Staff member can now login
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  ğŸ‘¤ STAFF: First Login                                               â”‚
â”‚                                                                       â”‚
â”‚  ğŸ“ Location: /auth/login                                            â”‚
â”‚  ğŸ–¥ï¸  Screen: Login Page                                              â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Login to Hospital Management System                         â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Email:                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ mrsonu1589@gmail.com                              â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Password:                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢                                  ğŸ‘ï¸    â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  [          Sign In          ]                              â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  âœ… Login successful!                                        â”‚   â”‚
â”‚  â”‚  Welcome to the Hospital Management System, Michel!          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Security Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Checkpoints Throughout the Flow                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Admin Authorization
   â”œâ”€ JWT token validation
   â”œâ”€ Tenant ID verification
   â””â”€ Admin role check

2. Email Verification
   â”œâ”€ OTP generation (6-digit random)
   â”œâ”€ 15-minute expiration
   â”œâ”€ Single-use token
   â””â”€ Secure storage in database

3. Password Creation
   â”œâ”€ Minimum 8 characters
   â”œâ”€ Uppercase requirement
   â”œâ”€ Lowercase requirement
   â”œâ”€ Number requirement
   â”œâ”€ Special character requirement
   â””â”€ Confirmation matching

4. Account Creation
   â”œâ”€ Cognito user creation
   â”œâ”€ Password hashing (bcrypt)
   â”œâ”€ Database user creation
   â”œâ”€ Staff profile creation
   â””â”€ Verification cleanup

5. Multi-Tenant Isolation
   â”œâ”€ Tenant-specific data storage
   â”œâ”€ Schema-based isolation
   â””â”€ No cross-tenant access
```

## ğŸ“Š Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Data Storage and Retrieval                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Staff Information
   â†“
   Stored in: user_verification.metadata (JSONB)
   Duration: 15 minutes
   â†“
Step 2: OTP Verification
   â†“
   Retrieved from: user_verification.metadata
   Validated: OTP code and expiration
   â†“
Step 3: Password Creation
   â†“
   Created in: AWS Cognito + users table
   Hashed: bcrypt
   â†“
Step 4: Staff Profile
   â†“
   Created in: staff_profiles table
   Linked to: users.id
   â†“
Final State: Complete staff account
   - Cognito user (confirmed)
   - Database user (active)
   - Staff profile (active)
   - Verification record (deleted)
```

---

**Visual Flow Complete** âœ…  
**Total Steps**: 4 main steps  
**Total Screens**: 3 frontend screens  
**Total API Calls**: 3 backend endpoints  
**Security Checkpoints**: 5 validation points  
**Data Storage**: 3 database tables involved

